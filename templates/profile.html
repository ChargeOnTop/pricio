{% extends "base.html" %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å{% endblock %}

{% block extra_css %}
<style>
    .profile-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
    }
    
    @media (max-width: 768px) {
        .profile-grid {
            grid-template-columns: 1fr;
        }
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }
    
    .stat-card {
        background: var(--bg-secondary);
        border-radius: var(--radius);
        padding: 1.25rem;
        text-align: center;
    }
    
    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
    }
    
    .stat-label {
        font-size: 0.875rem;
        color: var(--text-light);
        margin-top: 0.25rem;
    }
    
    .info-list {
        list-style: none;
    }
    
    .info-item {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--border);
    }
    
    .info-item:last-child {
        border-bottom: none;
    }
    
    .info-label {
        color: var(--text-light);
    }
    
    .info-value {
        font-weight: 500;
    }
    
    .telegram-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        border-radius: var(--radius);
        margin-bottom: 1rem;
    }
    
    .telegram-status.linked {
        background: #dcfce7;
        color: #166534;
    }
    
    .telegram-status.not-linked {
        background: #fef3c7;
        color: #92400e;
    }
    
    .telegram-steps {
        padding-left: 1.25rem;
        color: var(--text-light);
        font-size: 0.875rem;
        margin: 1rem 0;
    }
    
    .telegram-steps li {
        margin-bottom: 0.5rem;
    }
    
    .telegram-steps a {
        color: var(--primary);
    }
    
    .code-input {
        display: flex;
        gap: 0.5rem;
    }
    
    .code-input input {
        flex: 1;
        text-transform: uppercase;
        letter-spacing: 2px;
        text-align: center;
        font-weight: 600;
        font-family: monospace;
    }
    
    .quick-links {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">–ü—Ä–æ—Ñ–∏–ª—å</h1>
    <p class="page-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>
</div>

<div class="profile-grid">
    <div>
        <div class="card">
            <h2 class="card-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">{{ stats.favorites_count }}</div>
                    <div class="stat-label">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ stats.alerts_count }}</div>
                    <div class="stat-label">–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title">üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <ul class="info-list">
                <li class="info-item">
                    <span class="info-label">–õ–æ–≥–∏–Ω</span>
                    <span class="info-value">{{ stats.username }}</span>
                </li>
                <li class="info-item">
                    <span class="info-label">Email</span>
                    <span class="info-value">{{ stats.email }}</span>
                </li>
                <li class="info-item">
                    <span class="info-label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</span>
                    <span class="info-value">{{ stats.created_at[:10] if stats.created_at else '‚Äî' }}</span>
                </li>
            </ul>
        </div>
    </div>
    
    <div>
        <div class="card">
            <h2 class="card-title">üîî Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            
            {% if stats.telegram_linked %}
            <div class="telegram-status linked">
                ‚úÖ Telegram –ø—Ä–∏–≤—è–∑–∞–Ω
            </div>
            <p style="color: var(--text-light); margin-bottom: 1rem;">
                –í—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–Ω–∏–∂–µ–Ω–∏–∏ —Ü–µ–Ω –Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Ç–æ–≤–∞—Ä—ã.
            </p>
            <form action="/profile/unlink-telegram" method="POST">
                <button type="submit" class="btn btn-secondary">–û—Ç–≤—è–∑–∞—Ç—å Telegram</button>
            </form>
            
            {% else %}
            <div class="telegram-status not-linked">
                ‚ö†Ô∏è Telegram –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω
            </div>
            
            <p style="margin-bottom: 0.5rem;">–ü—Ä–∏–≤—è–∂–∏—Ç–µ Telegram –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</p>
            
            <ol class="telegram-steps">
                <li>–û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ <a href="https://t.me/{{ telegram_bot_username }}" target="_blank">@{{ telegram_bot_username }}</a></li>
                <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /start</li>
                <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥</li>
                <li>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ:</li>
            </ol>
            
            <form action="/profile/link-telegram" method="POST" class="code-input">
                <input type="text" name="code" class="form-input" placeholder="XXXXXXXX" maxlength="8" required pattern="[A-Fa-f0-9]{8}">
                <button type="submit" class="btn btn-primary">–ü—Ä–∏–≤—è–∑–∞—Ç—å</button>
            </form>
            {% endif %}
        </div>
        
        <div class="card">
            <h2 class="card-title">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="quick-links">
                <a href="/favorites" class="btn btn-secondary">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
                <a href="/store/5ka" class="btn btn-secondary">üõí –ü—è—Ç—ë—Ä–æ—á–∫–∞</a>
                <a href="/store/magnit" class="btn btn-secondary">üõí –ú–∞–≥–Ω–∏—Ç</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
